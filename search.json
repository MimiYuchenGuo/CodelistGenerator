[{"path":"https://oxford-pharmacoepi.github.io/CodelistGenerator/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2022 CodelistGenerator authors Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://oxford-pharmacoepi.github.io/CodelistGenerator/articles/Introduction_to_CodelistGenerator.html","id":"creating-a-codelist-for-dementia","dir":"Articles","previous_headings":"","what":"Creating a codelist for dementia","title":"Introduction to CodelistGenerator","text":"example going generate candidate codelist dementia, looking codes condition domain.","code":""},{"path":"https://oxford-pharmacoepi.github.io/CodelistGenerator/articles/Introduction_to_CodelistGenerator.html","id":"getting-the-omop-cdm-vocabularies","dir":"Articles","previous_headings":"","what":"Getting the OMOP CDM vocabularies","title":"Introduction to CodelistGenerator","text":"ready access database OMOP CDM, need first obtain OMOP CDM vocabularies https://athena.ohdsi.org. downloaded, can make vocabulary database like : structure tables described detail : https://ohdsi.github.io/CommonDataModel/cdm53.html#Vocabulary_Tables","code":"library(readr) library(DBI) library(RSQLite) library(here) vocab.folder<-Sys.getenv(\"omop_cdm_vocab_path\") # path to directory of unzipped files concept<-read_delim(paste0(vocab.folder,\"/CONCEPT.csv\"),      \"\\t\", escape_double = FALSE, trim_ws = TRUE) concept_relationship<-read_delim(paste0(vocab.folder,\"/CONCEPT_RELATIONSHIP.csv\"),      \"\\t\", escape_double = FALSE, trim_ws = TRUE)  concept_ancestor<-read_delim(paste0(vocab.folder,\"/CONCEPT_ANCESTOR.csv\"),      \"\\t\", escape_double = FALSE, trim_ws = TRUE) concept_synonym<-read_delim(paste0(vocab.folder,\"/CONCEPT_SYNONYM.csv\"),      \"\\t\", escape_double = FALSE, trim_ws = TRUE)  db <- dbConnect(RSQLite::SQLite(), \":memory:\") dbWriteTable(db, \"concept\", concept, overwrite=TRUE) dbWriteTable(db, \"concept_relationship\", concept_relationship, overwrite=TRUE) dbWriteTable(db, \"concept_ancestor\", concept_ancestor, overwrite=TRUE) dbWriteTable(db, \"concept_synonym\", concept_synonym, overwrite=TRUE) rm(concept,concept_relationship, concept_ancestor, concept_synonym) vocabulary_database_schema<-\"main\""},{"path":"https://oxford-pharmacoepi.github.io/CodelistGenerator/articles/Introduction_to_CodelistGenerator.html","id":"codelist-from-dementia-4182210-and-its-descendants","dir":"Articles","previous_headings":"","what":"Codelist from “Dementia” (4182210) and its descendants","title":"Introduction to CodelistGenerator","text":"simplest approach identifying potential codes take high-level code include descendents. looks pick relevant codes. , approach misses codes aren´t descendant 4182210. example, codes “Wandering due dementia” (37312577; https://athena.ohdsi.org/search-terms/terms/37312577) “Anxiety due dementia” (37312031; https://athena.ohdsi.org/search-terms/terms/37312031) aren´t picked .","code":"library(dplyr) library(stringr) library(DT) library(kableExtra) codes_from_descendants<-tbl(db,    sql(paste0(\"SELECT * FROM \",      vocabulary_database_schema,      \".concept_ancestor\"))) %>%    filter(ancestor_concept_id==\"4182210\") %>%    select(\"descendant_concept_id\") %>%    rename(\"concept_id\"=\"descendant_concept_id\") %>%    left_join(tbl(db, sql(paste0(\"SELECT * FROM \",      vocabulary_database_schema,      \".concept\"))))%>%   select(\"concept_id\", \"concept_name\",           \"domain_id\", \"vocabulary_id\") %>%    collect() datatable(codes_from_descendants,           rownames=FALSE,           options = list(pageLength = 10,                          lengthMenu = c(10, 20,50)))"},{"path":"https://oxford-pharmacoepi.github.io/CodelistGenerator/articles/Introduction_to_CodelistGenerator.html","id":"generating-a-candidate-codelist-using-codelist-generator","dir":"Articles","previous_headings":"","what":"Generating a candidate codelist using Codelist Generator","title":"Introduction to CodelistGenerator","text":"try include terms included can use CodelistGenerator. First, let’s simple search single keyword “dementia” without exclusions, without searching synonyms, including descendents ancestors. difference codelist one 4182210 descendants? extra codes picked CodelistGenerator?","code":"library(CodelistGenerator) dementia_codes1<-get_candidate_codes(keywords=\"dementia\",                     domains=\"Condition\",                     search.synonyms = FALSE,                     fuzzy.match = FALSE,                     exclude = NULL,                     include.descendants = TRUE,                     include.ancestor = FALSE,                     db=db,                     vocabulary_database_schema =  vocabulary_database_schema) datatable(dementia_codes1,           rownames=FALSE,           options = list(   pageLength = 10,   lengthMenu = c(10, 20,50) )) code_comparison<-full_join(codes_from_descendants  %>% mutate(type1=\"4182210 and descendants\"),                       dementia_codes1  %>% mutate(type2=\"CodelistGenerator\")) %>%    mutate(type=ifelse(!is.na(type1) & !is.na(type2),                      \"Both\",               ifelse(!is.na(type1) & is.na(type2),                      \"Only 4182210 and descendants\",               ifelse(is.na(type1) & !is.na(type2),                      \"Only CodelistGenerator\",                      NA)))) %>%    select(-c(\"type1\",\"type2\")) kable(code_comparison %>%    group_by(type) %>%    tally()) datatable(code_comparison %>%              filter(type==\"Only CodelistGenerator\"),           rownames=FALSE,           options = list(   pageLength = 10,   lengthMenu = c(10, 20,50) ))"},{"path":"https://oxford-pharmacoepi.github.io/CodelistGenerator/articles/Introduction_to_CodelistGenerator.html","id":"review-mappings-from-source-vocabularies","dir":"Articles","previous_headings":"","what":"Review mappings from source vocabularies","title":"Introduction to CodelistGenerator","text":"Perhaps want see ICD10CM codes map candidate codelist. can get running","code":"icd_mappings<-show_mappings(candidate_codelist=dementia_codes4,                     source_vocabularies=\"ICD10CM\",                     db=db,                     vocabulary_database_schema =  vocabulary_database_schema) datatable(icd_mappings,           rownames=FALSE,           options = list(   pageLength = 10,   lengthMenu = c(10, 20,50) )) read_mappings<-show_mappings(candidate_codelist=dementia_codes4,                     source_vocabularies=\"Read\",                     db=db,                     vocabulary_database_schema =  vocabulary_database_schema) datatable(read_mappings,           rownames=FALSE,           options = list(   pageLength = 10,   lengthMenu = c(10, 20,50) ))"},{"path":"https://oxford-pharmacoepi.github.io/CodelistGenerator/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Edward Burn. Author, maintainer.","code":""},{"path":"https://oxford-pharmacoepi.github.io/CodelistGenerator/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Burn E (2022). CodelistGenerator: Genrate candidate codelists OMOP CDM. R package version 0.0.0.9000, https://oxford-pharmacoepi.github.io/CodelistGenerator/.","code":"@Manual{,   title = {CodelistGenerator: Genrate candidate codelists for the OMOP CDM},   author = {Edward Burn},   year = {2022},   note = {R package version 0.0.0.9000},   url = {https://oxford-pharmacoepi.github.io/CodelistGenerator/}, }"},{"path":[]},{"path":"https://oxford-pharmacoepi.github.io/CodelistGenerator/index.html","id":"introduction","dir":"","previous_headings":"","what":"Introduction","title":"Genrate candidate codelists for the OMOP CDM","text":"goal CodelistGenerator create candidate set codes generating phenotype OMOP CDM. well using package R, corresponding RShiny app creating candidate codelists using OMOP CDM condition (https://dpa-pde-oxford.shinyapps.io/OmopCodelistGeneratorConditions/), observation (add), measurement (add), procedures (add) available.","code":""},{"path":"https://oxford-pharmacoepi.github.io/CodelistGenerator/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Genrate candidate codelists for the OMOP CDM","text":"can install development version CodelistGenerator like :","code":"install.packages(\"remotes\") remotes::install_github(\"oxford-pharmacoepi/CodelistGenerator\")"},{"path":"https://oxford-pharmacoepi.github.io/CodelistGenerator/index.html","id":"example","dir":"","previous_headings":"","what":"Example","title":"Genrate candidate codelists for the OMOP CDM","text":"","code":"# Note, Eunomia, used in the example below, does not include a full set of vocabularies.  library(CodelistGenerator) library(dplyr) library(Eunomia) library(RSQLite) library(DBI) untar(xzfile(system.file(\"sqlite\", \"cdm.tar.xz\", package = \"Eunomia\"), open = \"rb\"),         exdir =  tempdir()) db <- dbConnect(RSQLite::SQLite(), paste0(tempdir(),\"\\\\cdm.sqlite\")) get_candidate_codes(keywords=\"asthma\",                     db=db,                     vocabulary_database_schema = \"main\") #> [1] \"Limiting to potential concepts of interest (database side)\" #> [1] \"Bringing filtered tables into memory\" #> [1] \"Getting concepts to include from exact matches\" #> [1] \"Getting concepts to include from descendants of identified concepts\" #> [1] \"Getting candidate codelist took 0 minutes and 1 seconds\" #> # A tibble: 3 x 4 #>   concept_id concept_name     domain_id vocabulary_id #>        <dbl> <chr>            <chr>     <chr>         #> 1    4051466 Childhood asthma Condition SNOMED        #> 2     317009 Asthma           Condition SNOMED        #> 3    4062501 Asthma screening Procedure SNOMED"},{"path":"https://oxford-pharmacoepi.github.io/CodelistGenerator/reference/clean_words.html","id":null,"dir":"Reference","previous_headings":"","what":"Prepare words for search. — clean_words","title":"Prepare words for search. — clean_words","text":"Prepare words search.","code":""},{"path":"https://oxford-pharmacoepi.github.io/CodelistGenerator/reference/clean_words.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Prepare words for search. — clean_words","text":"","code":"clean_words(words)"},{"path":"https://oxford-pharmacoepi.github.io/CodelistGenerator/reference/clean_words.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Prepare words for search. — clean_words","text":"words character vector.","code":""},{"path":"https://oxford-pharmacoepi.github.io/CodelistGenerator/reference/clean_words.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Prepare words for search. — clean_words","text":"character vector length.","code":""},{"path":"https://oxford-pharmacoepi.github.io/CodelistGenerator/reference/clean_words.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Prepare words for search. — clean_words","text":"","code":"clean_words(c(\"Type-1 diabetes \")) #> [1] \"type1 diabetes\""},{"path":"https://oxford-pharmacoepi.github.io/CodelistGenerator/reference/get_candidate_codes.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate candidate codelist for the OMOP CDM — get_candidate_codes","title":"Generate candidate codelist for the OMOP CDM — get_candidate_codes","text":"function generates set codes can considered creating phenotype using OMOP CDM.","code":""},{"path":"https://oxford-pharmacoepi.github.io/CodelistGenerator/reference/get_candidate_codes.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate candidate codelist for the OMOP CDM — get_candidate_codes","text":"","code":"get_candidate_codes(   keywords,   domains = c(\"Condition\", \"Drug\", \"Device\", \"Observation\", \"Procedure\"),   search.synonyms = FALSE,   fuzzy.match = FALSE,   fuzzy.match.max.distance = 0.1,   exclude = NULL,   include.descendants = TRUE,   include.ancestor = FALSE,   verbose = FALSE,   db,   vocabulary_database_schema )"},{"path":"https://oxford-pharmacoepi.github.io/CodelistGenerator/reference/get_candidate_codes.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate candidate codelist for the OMOP CDM — get_candidate_codes","text":"keywords Character vector words search . one word given (e.g. \"knee osteoarthritis\"), words identified can different positions (e.g. \"osteoarthritis knee\") identified. domains Character vector one OMOP CDM domain (e.g. \"Condition\"). search.synonyms Either TRUE FALSE. TRUE code also search via concept synonym table. fuzzy.match Either TRUE FALSE. TRUE fuzzy matches used, approximate matches identified. fuzzy.match.max.distance max.distance parmeter fuzzy matching (see ??base::agrep details). exclude Character vector words search identify concepts exclude. include.descendants Either TRUE FALSE. TRUE descendant concepts identified concepts included candidate codelist. include.ancestor Either TRUE FALSE. TRUE direct ancestor concepts identified concepts included candidate codelist. verbose Either TRUE FALSE. TRUE, progress printed. db Database connection via DBI::dbConnect() vocabulary_database_schema Name database schema vocab tables","code":""},{"path":"https://oxford-pharmacoepi.github.io/CodelistGenerator/reference/get_candidate_codes.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate candidate codelist for the OMOP CDM — get_candidate_codes","text":"Dataframe","code":""},{"path":"https://oxford-pharmacoepi.github.io/CodelistGenerator/reference/get_candidate_codes.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Generate candidate codelist for the OMOP CDM — get_candidate_codes","text":"","code":"### note, Eunomia, used in the example below, does not include a full set of vocabularies. ### The full set can be downloaded from https://athena.ohdsi.org library(Eunomia) #> Loading required package: DatabaseConnector library(DBI) library(RSQLite) untar(xzfile(system.file(\"sqlite\", \"cdm.tar.xz\", package = \"Eunomia\"), open = \"rb\"),        exdir =  tempdir()) db <- DBI::dbConnect(RSQLite::SQLite(), paste0(tempdir(),\"\\\\cdm.sqlite\")) get_candidate_codes(keywords=\"asthma\",                    search.synonyms=TRUE,                              fuzzy.match=TRUE,                              exclude=NULL,                              include.descendants=TRUE,                              include.ancestor=FALSE,                    db=db,                    vocabulary_database_schema = \"main\") #> Error: no such table: main.concept"},{"path":"https://oxford-pharmacoepi.github.io/CodelistGenerator/reference/show_mappings.html","id":null,"dir":"Reference","previous_headings":"","what":"Show mappings from source vocabularies to standard — show_mappings","title":"Show mappings from source vocabularies to standard — show_mappings","text":"Show mappings source vocabularies standard","code":""},{"path":"https://oxford-pharmacoepi.github.io/CodelistGenerator/reference/show_mappings.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Show mappings from source vocabularies to standard — show_mappings","text":"","code":"show_mappings(   candidate_codelist,   source_vocabularies = c(\"ATC\", \"ICD10CM\", \"ICD10PCS\", \"ICD9CM\", \"ICD9Proc\", \"LOINC\",     \"OPCS4\", \"Read\", \"RxNorm\", \"RxNorm Extension\", \"SNOMED\"),   db,   vocabulary_database_schema )"},{"path":"https://oxford-pharmacoepi.github.io/CodelistGenerator/reference/show_mappings.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Show mappings from source vocabularies to standard — show_mappings","text":"candidate_codelist Dataframe source_vocabularies Character vector db Database connection via DBI::dbConnect() vocabulary_database_schema Name database schema vocab tables","code":""},{"path":"https://oxford-pharmacoepi.github.io/CodelistGenerator/reference/show_mappings.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Show mappings from source vocabularies to standard — show_mappings","text":"Dataframe","code":""},{"path":"https://oxford-pharmacoepi.github.io/CodelistGenerator/reference/show_mappings.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Show mappings from source vocabularies to standard — show_mappings","text":"","code":"### note, Eunomia, which is used for the example below, ### does not include a full set of vocabularies. ### The full set can be downloaded from https://athena.ohdsi.org library(Eunomia) library(RSQLite) library(dplyr) #>  #> Attaching package: ‘dplyr’ #> The following objects are masked from ‘package:stats’: #>  #>     filter, lag #> The following objects are masked from ‘package:base’: #>  #>     intersect, setdiff, setequal, union library(DBI) untar(xzfile(system.file(\"sqlite\", \"cdm.tar.xz\", package = \"Eunomia\"), open = \"rb\"),      exdir =  tempdir()) db <- DBI::dbConnect(RSQLite::SQLite(), paste0(tempdir(),\"\\\\cdm.sqlite\")) asthma_codes<-get_candidate_codes(keywords=\"asthma\",                  db=db,                  vocabulary_database_schema = \"main\") #> Error: no such table: main.concept show_mappings(candidate_codelist= asthma_codes,                  db=db,                  vocabulary_database_schema = \"main\") #> Error in isTRUE(lhs): object 'asthma_codes' not found"}]
